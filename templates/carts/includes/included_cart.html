{% load static %}
{% load carts_tags %}

{% user_carts request as carts %}

<!-- Cart Start -->
<div class="d-inline-block d-flex flex-wrap" style="padding-left: 10px;">
    <!-- Есть товар в корзине Начало -->
    {% if carts %}
        <!-- Таблица с товаром Начало -->
        <div class="col-lg-13 table-responsive mb-3 d-inline-block d-flex" style="justify-content: center;">  
            <table class="table table-light table-borderless table-hover text-center mb-0">
                <thead class="thead-dark">
                    <tr>
                        <th></th>
                        <th>Название</th>
                        <th>Цена</th>
                        <th>Количество</th>
                        <th>Всего</th>
                        <th>Удалить</th>
                    </tr>
                </thead>
                {% for cart in carts %}
                    <div class="align-middle">
                        <tr>
                            <td class="align-middle">
                                <img src="{{ cart.product.image.url }}" alt="" style="width: 100px;">
                            </td>
                            <td class="align-middle"> 
                                <a href="{% url "catalog:product" cart.product.slug %}" 
                                    style="Color: #6C757D;" onmouseover="style.color='#e6b400'" onmouseout="style.color='#6C757D'">
                                    {{ cart.product.name }}
                                </a>
                            </td>
                            <td class="align-middle" style="width: 150px;">{{ cart.product.sell_price }} ₽</td>
                            <td class="align-middle">
                                <div class="input-group quantity mx-auto" style="width: 100px;">
                                    <div class="input-group-btn">
                                        <button class="btn btn-sm btn-primary btn-minus decrement"
                                        data-cart-id="{{ cart.id }}" 
                                        data-cart-change-url="{% url "cart:cart_change" %}">
                                        {% csrf_token %}
                                        <i class="fa fa-minus"></i>
                                        </button>
                                    </div>
                                    <input type="text" class="form-control form-control-sm bg-secondary border-0 text-center" value="{{ cart.quantity }}">
                                    <div class="input-group-btn">
                                        <button class="btn btn-sm btn-primary btn-plus increment"
                                        data-cart-id="{{ cart.id }}" 
                                        data-cart-change-url="{% url "cart:cart_change" %}">
                                        {% csrf_token %}
                                            <i class="fa fa-plus"></i>
                                        </button>
                                    </div>
                                </div>
                            </td>
                            <td class="align-middle" style="width: 200px;">{{ cart.products_price }} ₽</td>
                            <td class="align-middle"><a class="remove-from-cart align-middle" href="{% url "cart:cart_remove" %}"
                                data-cart-id="{{ cart.id }}">
                                {% csrf_token %}
                                <button class="btn btn-sm btn-danger"><i class="fa fa-times"></i></button></a>
                            </td>
                        </tr>
                    </div>
                {% endfor %}
            </table>
        </div>
        <!-- Таблица с товаром Конец -->

        <!-- Итого сумма заказа Начало -->
        <div class="col-lg-15 bg-light p-30 mb-5" style="justify-content: center;">       
            <div class="border-bottom pb-2">
                <div class="d-flex justify-content-between mb-3">
                    <h6>Итого</h6>
                    <h6>{{ carts.total_price }} ₽</h6>
                </div>
                <div class="d-flex justify-content-between">
                    <h6 class="font-weight-medium">Доставка</h6>
                    <h6 class="font-weight-medium">0 ₽</h6>
                </div>
            </div>
            <div class="pt-2">
                <div class="d-flex justify-content-between mt-2">
                    <h5 class="float-left">Итого <strong>{{ carts.total_quantity }}</strong> товар(а) <br>на сумму</h5>
                    <h5>{{ carts.total_price }} ₽</h5>
            </div>
            <a class="btn btn-block btn-primary font-weight-bold my-3 py-3" href="orders/create_order.html">Оформить заказ</a>
        </div>
        <!-- Итого сумма заказа конец -->

    <!-- Есть товар в корзине Конец -->

    <!-- Пустая корзина Начало -->
    {% else %}
        <div class="container text-center" style="padding-left: 40px;">
            {% if title == "MultiShop - Корзина" or title == "MultiShop - Кабинет" %}
                <h3 class="text-center mb-4"><span class="bg-secondary pr-3">Корзина</span></h3>
            {% endif %}
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12 table-responsive mb-3" style="padding: 0px;">
                        <table class="table table-light table-borderless table-hover text-center mb-0">
                            <thead class="thead-dark">
                                <tr>
                                    <th></th>
                                    <th>Название</th>
                                    <th>Цена</th>
                                    <th>Количество</th>
                                    <th>Всего</th>
                                    <th>Удалить</th>
                                </tr>
                            </thead>
                        </table>   
                    </div>
                </div>
            </div> 
            <div class="bg-light p-30 mb-5 text-center">
                <img src="{% static "img/Пустая корзина.PNG" %}" class="pb-2" style="width: 200px;">
                <h5>Пока пусто</h5>
                <a class="h5" href="{% url "main:all_categories" %}" style="Color: #e6b400;">Перейти в каталог</a>
            </div>
        </div>
    {% endif %}
    <!-- Пустая корзина Конец -->
</div>